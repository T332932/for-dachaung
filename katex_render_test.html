<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>KaTeX 渲染测试</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"></script>
    <style>
        body {
            font-family: system-ui;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background: #1a1a2e;
            color: #eee;
        }

        .section {
            background: #16213e;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
        }

        h2 {
            color: #6366f1;
        }

        .option {
            padding: 5px 10px;
            margin: 5px 0;
            background: #0f3460;
            border-radius: 4px;
        }
    </style>
</head>

<body>
    <h1>KaTeX 渲染测试</h1>

    <div class="section">
        <h2>题干</h2>
        <div id="questionText"></div>
    </div>

    <div class="section">
        <h2>选项</h2>
        <div id="options"></div>
    </div>

    <div class="section">
        <h2>答案</h2>
        <div id="answer"></div>
    </div>

    <script>
        // 这是从 AI 返回的数据（JSON.parse 后的结果）
        const data = {
            "questionText": "10. 下图是函数 $y = \\sin(\\omega x + \\phi)$ 的部分图像，则 $\\sin(\\omega x + \\phi)=$\n\n![函数图像](...) \n",
            "options": [
                "A. $\\sin(x + \\frac{\\pi}{3})$",
                "B. $\\sin(\\frac{\\pi}{3} - 2x)$",
                "C. $\\cos(2x + \\frac{\\pi}{6})$",
                "D. $\\cos(\\frac{5\\pi}{6} - 2x)$"
            ],
            "answer": "### 解题步骤：\n\n1.  **确定角频率 $\\omega$**\n    根据函数图像，我们可以看到函数在 $x = \\frac{\\pi}{6}$ 和 $x = \\frac{2\\pi}{3}$ 处连续两次穿过 x 轴。"
        };

        // 显示题干
        document.getElementById('questionText').innerHTML = data.questionText;

        // 显示选项
        const optionsHtml = data.options.map(opt => `<div class="option">${opt}</div>`).join('');
        document.getElementById('options').innerHTML = optionsHtml;

        // 显示部分答案
        document.getElementById('answer').innerHTML = data.answer;

        // 使用 KaTeX 自动渲染
        renderMathInElement(document.body, {
            delimiters: [
                { left: '$$', right: '$$', display: true },
                { left: '$', right: '$', display: false }
            ],
            throwOnError: false
        });

        console.log("原始数据：", data);
        console.log("选项B原始字符串：", data.options[1]);
        console.log("选项B字符编码：", [...data.options[1]].map(c => c.charCodeAt(0)));
    </script>
</body>

</html>