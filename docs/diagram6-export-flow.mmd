%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#f0f7ff', 'edgeLabelBackground':'#ffffff', 'tertiaryColor': '#e6f3ff', 'primaryTextColor': '#003366', 'primaryBorderColor': '#003366', 'lineColor': '#003366'}}}%%
flowchart TB
    subgraph Select["选题阶段"]
        A["从题库选择题目"]
        B["设置试卷参数<br/>题型/分值/难度"]
    end
    
    subgraph Analysis["智能分析"]
        C["AI 分析难度分布"]
        D["知识点覆盖检查"]
        E["试卷结构优化"]
    end
    
    subgraph Export["导出生成"]
        F{"选择导出格式"}
        G["LaTeX 模板渲染"]
        H["pdflatex 编译"]
        I["python-docx 生成"]
        J[/"PDF 试卷"\]
        K[/"Word 试卷"\]
    end
    
    A --> B --> C --> D --> E --> F
    F -->|PDF 格式| G --> H --> J
    F -->|Word 格式| I --> K
